"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_code-view-shared_components_files-search_FileResultsList_tsx"],{56265:(e,t,r)=>{r.d(t,{R:()=>a});function a(e,t,{direction:r="vertical",startMargin:a=0,endMargin:l=0,behavior:n="smooth"}={}){let s="vertical"===r?"top":"left",i="vertical"===r?"bottom":"right",o="vertical"===r?"scrollTop":"scrollLeft",{[s]:c,[i]:u}=e.getBoundingClientRect(),{[s]:d,[i]:f}=t.getBoundingClientRect();if(c<d+a){let e=c-d+t[o];t.scrollTo({behavior:n,[s]:e-a})}else if(u>f-l){let e=u-f+t[o];t.scrollTo({behavior:n,[s]:e+l})}}},91385:(e,t,r)=>{r.d(t,{Xq:()=>i,ai:()=>l,fN:()=>s,qA:()=>o});var a=-1/0,l=1/0;function n(e,t,r,l){for(var n=e.length,s=t.length,i=e.toLowerCase(),o=t.toLowerCase(),c=function(e){for(var t=e.length,r=Array(t),a="/",l=0;l<t;l++){var n,s=e[l];"/"===a?r[l]=.9:"-"===a||"_"===a||" "===a?r[l]=.8:"."===a?r[l]=.6:(n=a).toLowerCase()===n&&s.toUpperCase()===s?r[l]=.7:r[l]=0,a=s}return r}(t,c),u=0;u<n;u++){r[u]=Array(s),l[u]=Array(s);for(var d=a,f=u===n-1?-.005:-.01,h=0;h<s;h++)if(i[u]===o[h]){var m=a;u?h&&(m=Math.max(l[u-1][h-1]+c[h],r[u-1][h-1]+1)):m=-.005*h+c[h],r[u][h]=m,l[u][h]=d=Math.max(m,d+f)}else r[u][h]=a,l[u][h]=d+=f}}function s(e,t){var r=e.length,s=t.length;if(!r||!s)return a;if(r===s)return l;if(s>1024)return a;var i=Array(r),o=Array(r);return n(e,t,i,o),o[r-1][s-1]}function i(e,t){var r=e.length,l=t.length,s=Array(r);if(!r||!l)return s;if(r===l){for(var i=0;i<r;i++)s[i]=i;return s}if(l>1024)return s;var o=Array(r),c=Array(r);n(e,t,o,c);for(var u=!1,i=r-1,d=l-1;i>=0;i--)for(;d>=0;d--)if(o[i][d]!==a&&(u||o[i][d]===c[i][d])){u=i&&d&&c[i][d]===o[i-1][d-1]+1,s[i]=d--;break}return s}function o(e,t){e=e.toLowerCase(),t=t.toLowerCase();for(var r=e.length,a=0,l=0;a<r;a+=1)if(0===(l=t.indexOf(e[a],l)+1))return!1;return!0}},37363:(e,t,r)=>{r.d(t,{z:()=>WebWorker});let WebWorker=class WebWorker{set onmessage(e){this.worker.onmessage=e}postMessage(e){this.worker.postMessage(e)}terminate(){this.worker.terminate()}constructor(e,t){try{this.worker=new Worker(e)}catch(e){console.warn("Web workers are not available. Please enable web workers to benefit from the improved performance."),this.worker=new MainThreadWorker(t)}}};let MainThreadWorker=class MainThreadWorker{async postMessage(e){if(this.terminated)return;let t={data:this.job({data:e})};this.onmessage?.(t)}terminate(){this.terminated=!0}constructor(e){this.job=e,this.terminated=!1}}},28610:(e,t,r)=>{r.r(t),r.d(t,{FileResultRow:()=>$,default:()=>D});var a=r(74848),l=r(43772),n=r(57294),s=r(61836),i=r(18704),o=r(89504),c=r(6032),u=r(83056),d=r(56226),f=r(42024),h=r(27788),m=r(94120),p=r(56265),x=r(59857),g=r(82678),v=r(75177),y=r(65481),w=r(17909),b=r(86519),A=r(85349),C=r(38553),R=r(30729),j=r(91385),E=r(96540),N=r(37363),k=r(5225);let S=(0,k.A)(j.fN);function L({data:e}){let{query:t,baseList:r,startTime:a}=e,l=t.replaceAll("\\","");return{query:t,list:r.filter(e=>""===l||(0,j.qA)(l,e)&&S(l,e)>0).sort((e,t)=>S(l,t)-S(l,e)),baseCount:r.length,startTime:a}}var F=r(27510),T=r(28784);async function I(e){let t=await (0,T.lS)(e);return t.ok?await t.json():void 0}let _=new Map,M=(0,k.A)(I,{cache:_}),q={excludeDirectories:!1,excludeSeeAllResults:!1};function D({actionListSx:e={},additionalResults:t,commitOid:r,config:d=q,findFileWorkerPath:x,getItemUrl:C,onRenderRow:R,onItemSelected:j,searchBoxRef:k,sx:S={}}){let{excludeDirectories:T,excludeSeeAllResults:I}=d,{query:_,setQuery:D}=(0,l.JS)(),$=(0,o.t)(),z=E.useRef(null),H=k??z,[G,O]=E.useState(_.length>0),[U,V]=E.useState(!!_),{list:P,directories:Z,loading:K,error:X}=function(e,t,r){let a=(0,o.t)(),[l,n]=(0,E.useState)({list:[],directories:[],loading:!0}),s=(0,u.Cl)({repo:a,commitOid:e,includeDirectories:!r});return(0,E.useEffect)(()=>{let e=!1,r=async()=>{n({list:[],directories:[],loading:!0});let t=await M(s);if(e)return;let r=t?.paths||[],a=t?.directories||[];n({list:r.concat(a).sort(),directories:a,error:!t})};return t&&r(),function(){e=!0}},[s,t,r]),l}(r,G,!!T),{path:Y}=(0,n.eu)(),{getUrl:J}=(0,i.Z)(),{queryText:Q,queryLine:ee}=function(e){let t=(e=e.replaceAll(" ","")).indexOf(":");return t>=0?{queryText:e.substring(0,t),queryLine:parseInt(e.substring(t+1),10)}:{queryText:e,queryLine:void 0}}(_),{matches:et,clearMatches:er}=function(e,t,r,a){let[l,n]=E.useState(),i=E.useRef(""),o=E.useRef(),{sendStats:c}=(0,s.T)(),u=E.useRef(!1),d=E.useCallback(()=>{let e=new N.z(r,L);e.onmessage=({data:e})=>{u.current=!1,n(e.list),i.current=e.query,e.startTime&&c("repository.find-file",{"find-file-base-count":e.baseCount,"find-file-results-count":e.list.length,"find-file-duration-ms":performance.now()-e.startTime})},o.current=e},[c,r]);return E.useEffect(()=>{if(a)return d(),function(){o.current?.terminate()}},[d,a]),E.useEffect(()=>{if(e.length&&t){u.current&&(o.current?.terminate(),d());let r=i.current&&t.startsWith(i.current);u.current=!0,o.current?.postMessage({baseList:r&&l||e,query:t,startTime:performance.now()})}},[e,t,d]),{matches:l,clearMatches:()=>n(void 0)}}((0,E.useMemo)(()=>[...P,...t??[]].sort(),[t,P]),Q,x,G),{sendRepoClickEvent:ea}=(0,s.T)(),el=(0,h.Z)(),[en,es]=E.useState(0),[ei,eo]=E.useState((0,F.q)()),ec=E.useRef(null),eu=E.useRef(null),ed="file-results-list",{sendRepoKeyDownEvent:ef}=(0,s.T)(),{screenSize:eh}=(0,f.lm)(),em=d.useOverlay??eh>=f.Gy.large,ep=E.useCallback(()=>{ea("FILE_TREE.SEARCH_RESULT_CLICK"),j?.(),V(!1)},[ea,j]),ex=(e,t,r)=>C?C(e,t,r):J({path:e,action:t?"tree":"blob",hash:r}),{containerRef:eg}=(0,g.G)({bindKeys:m.z0.ArrowVertical|m.z0.HomeAndEnd,focusInStrategy:"previous"},[K,X]);E.useEffect(()=>{_||V(!1)},[_]),E.useEffect(()=>{document.activeElement!==H.current&&em&&V(!1)},[Y,H,em]);let ev=et?.slice(0,40)||[],ey=et&&et.length>ev.length,ew=(0,a.jsx)(v.A,{sx:{maxHeight:em?"60vh":"100% !important",overflowY:"auto",scrollbarGutter:"stable",maxWidth:"100vw","@media (max-width: 768px)":{ml:3,mr:2}},children:X?(0,a.jsx)(y.A,{variant:"danger",className:"m-3",children:"Failed to search"}):(0,a.jsxs)(w.l,{ref:eg,sx:{overflow:"auto",p:em?2:3,width:"100%",pr:em?3:0,pt:em?3:"2px !important",...e},role:"listbox",children:[!K&&ev.map((e,t)=>{let r=Z.includes(e),l=ex(e,r,ee?`L${ee}`:"");return(0,a.jsx)(B,{active:e===Y,index:t,focused:ei&&en===t,match:e,onRender:R,query:Q,onClick:ep,isDirectory:r,to:l,useOverlay:em,listRef:eg},e)}),(0,a.jsxs)("div",{className:"m-3 text-center",children:[(0,a.jsx)(W,{loading:K||!et,visibleResultCount:ev.length,truncated:!!ey}),ey&&!I&&(0,a.jsxs)(a.Fragment,{children:["\xa0",(0,a.jsx)(b.A,{id:"see-all-results-link",className:"focus-visible",ref:ec,href:(0,u.Y8)({owner:$.ownerLogin,repo:$.name,searchTerm:`path:${Q}`}),sx:ei&&en===ev.length?{outline:"2px solid var(--focus-outlineColor, var(--color-accent-fg))",outlineOffset:"-2px",boxShadow:"none"}:{},children:"See all results"})]})]})]})});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.A,{ref:eu,sx:{mx:2,ml:3,...S},children:(0,a.jsx)(F.Z,{ariaActiveDescendant:(!em&&_||em&&U)&&ei&&en>-1?ey&&en===ev.length?"see-all-results-link":`file-result-${en}`:void 0,ariaExpanded:em?U:void 0,ariaHasPopup:em,ariaControls:em?ed:void 0,ref:H,query:_,onKeyDown:e=>{let{key:t,shiftKey:r,metaKey:a,altKey:l,ctrlKey:n}=e;if(!r&&!a&&!l){if("Escape"===t)_?(ef("FILE_TREE.CANCEL_SEARCH"),D(""),er()):document.activeElement&&document.activeElement.blur();else if(!_)return;else if("Enter"===t)!I&&ey&&en===ev.length?(el((0,u.Y8)({owner:$.ownerLogin,repo:$.name,searchTerm:`path:${Q}`})),j?.()):ev[en]&&(el(ex(ev[en],!1,ee?`L${ee}`:"")),V(!1),j?.());else if("ArrowDown"===t||n&&"n"===t){if(!I&&ey&&en>=ev.length-1){if(es(ev.length),ec.current&&eg.current){let e=(0,c.U)(eg.current);(0,p.R)(ec.current,e,{behavior:"instant"})}}else es(Math.min(en+1,ev.length-1));e.preventDefault();return}else if("ArrowUp"===t||n&&"p"===t){es(Math.max(en-1,0)),e.preventDefault();return}}},onPreload:()=>O(!0),onSearch:e=>{D(e),e?V(!0):(er(),V(!1)),es(0)},onBlur:e=>{eg.current?.contains(e.relatedTarget)||(V(!1),eo(!1))},onFocus:()=>{_&&V(!0),eo(!0)},sx:{minWidth:"160px"}})}),em&&(0,a.jsx)(A.T,{anchorRef:eu,open:em&&U,renderAnchor:null,onClose:()=>{V(!1)},focusZoneSettings:{disabled:!0},focusTrapSettings:{disabled:!0},width:"xlarge",align:"end",overlayProps:{id:ed,role:"dialog"},children:ew}),!em&&_&&ew]})}function W({visibleResultCount:e,truncated:t,loading:r}){return(0,a.jsx)("span",{role:"status",className:r||t||0===e?void 0:"sr-only","aria-label":r?"Loading":void 0,children:r?(0,a.jsx)(C.A,{size:"large"}):0===e?"No matches found":t?`First ${e} files shown.`:`Showing ${e} files.`},"results-count-status")}let $=({active:e,focused:t,index:r,match:l,query:n,to:s,isDirectory:i,onClick:o,onRender:u,useOverlay:f,listRef:h})=>{let m=(0,j.Xq)(n,l);u?.();let x=E.useRef(null),g=i?z:H;E.useEffect(()=>{if(t&&x.current&&h?.current){let e=(0,c.U)(h.current);(0,p.R)(x.current,e,{behavior:"instant"})}},[t,h]);let y={};return t&&(y={outline:"none",border:"2 solid",boxShadow:"0 0 0 2px #0969da"}),(0,a.jsx)(w.l.Item,{id:`file-result-${r}`,ref:x,as:d.N,onSelect:o,to:s,active:e,sx:{fontWeight:"normal",":hover":{textDecoration:"none"},mx:"2px",width:"calc(100% - 4px)",...y},role:"option","data-focus-visible-added":t||void 0,tabIndex:f?-1:0,children:(0,a.jsxs)("div",{className:"d-flex",children:[(0,a.jsx)("div",{className:"d-flex flex-1 flex-column overflow-hidden",children:(0,a.jsx)(G,{text:l,positionsList:m,sx:{color:"fg.muted"},LeadingIcon:g})}),t&&(0,a.jsx)(v.A,{sx:{pl:1,whiteSpace:"nowrap",color:"fg.muted"},children:`Go to ${i?"folder":"file"}`})]})},l)},z=()=>(0,a.jsx)(R.A,{"aria-label":"Directory",icon:x.FileDirectoryFillIcon,sx:{color:"var(--treeViewItem-leadingVisual-iconColor-rest, var(--color-icon-directory))",mr:2},size:"small"}),H=()=>(0,a.jsx)(R.A,{"aria-label":"File",icon:x.FileIcon,className:"fgColor-muted mr-2",size:"small"}),B=E.memo($);function G({text:e,positionsList:t,sx:r,LeadingIcon:l}){let n=[],s=0;for(let r of t){if(Number(r)!==r||r<s||r>e.length)continue;let t=e.slice(s,r);t&&n.push(O(t)),s=r+1,n.push((0,a.jsx)("mark",{className:"text-bold bgColor-transparent fgColor-default",children:e[r]},r))}return n.push(O(e.slice(s))),(0,a.jsx)(v.A,{sx:r,children:(0,a.jsxs)(a.Fragment,{children:[l&&(0,a.jsx)(l,{}),n]})})}function O(e){return e.replaceAll("/","/\u200B")}try{D.displayName||(D.displayName="FileResultsList")}catch{}try{W.displayName||(W.displayName="FileResultsStatus")}catch{}try{$.displayName||($.displayName="FileResultRow")}catch{}try{z.displayName||(z.displayName="DirectoryIcon")}catch{}try{H.displayName||(H.displayName="FileResultIcon")}catch{}try{B.displayName||(B.displayName="MemoizedFileResultRow")}catch{}try{G.displayName||(G.displayName="HighlightMatch")}catch{}},27510:(e,t,r)=>{r.d(t,{Z:()=>f,q:()=>h});var a=r(74848),l=r(70170),n=r(96810),s=r(61836),i=r(97156),o=r(59857),c=r(44981),u=r(75177),d=r(96540);let f=d.forwardRef(({ariaActiveDescendant:e,ariaControls:t,ariaExpanded:r,ariaHasPopup:i,onBlur:f,onFocus:m,onKeyDown:p,onPreload:x,onSearch:g,query:v,sx:y={}},w)=>{let{sendRepoClickEvent:b}=(0,s.T)(),[A,C]=d.useState(v),R=d.useRef((0,l.s)(e=>g(e),250));d.useEffect(()=>{C(v)},[v]);let j=v?(0,a.jsx)(c.A.Action,{onClick:()=>{b("FILE_TREE.CANCEL_SEARCH"),g("")},icon:o.XCircleFillIcon,"aria-label":"Clear",className:"fgColor-muted"}):void 0;return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(c.A,{autoFocus:h(),ref:w,value:A,onKeyDown:p,onChange:e=>{C(e.target.value),x(),R.current(e.target.value)},sx:{display:"flex",...y},"aria-label":"Go to file","aria-activedescendant":e,role:i?"combobox":void 0,"aria-controls":t,"aria-expanded":r,"aria-haspopup":i?"dialog":void 0,autoCorrect:"off",spellCheck:"false",placeholder:"Go to file",leadingVisual:o.SearchIcon,trailingAction:j,trailingVisual:j?void 0:()=>(0,a.jsx)(n.E,{children:(0,a.jsx)(u.A,{sx:{mr:"-6px"},children:(0,a.jsx)("kbd",{children:"t"})})}),onFocus:e=>{x(),e.target.select(),m?.(e)},onBlur:f,onClick:()=>b("FILE_TREE.SEARCH_BOX")})})});function h(){return"1"===new URLSearchParams(i.fV.search).get("search")}f.displayName="FilesSearchBox"}}]);
//# sourceMappingURL=ui_packages_code-view-shared_components_files-search_FileResultsList_tsx-c63c9f1aa9b7.js.map